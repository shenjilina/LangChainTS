# LangChain Chat Assistant 项目规范

## 📋 项目概述

本项目是一个基于 Nuxt 3、LangChain 和 Ollama 的智能聊天助手应用，旨在提供高质量的本地化 AI 对话体验。

## 🏗️ 架构设计

### 技术栈选择

- **前端框架**: Nuxt 3 - 提供 SSR、自动路由、优化构建等功能
- **UI 框架**: Vue 3 + Composition API - 现代化的响应式框架
- **UI 组件库**: Element Plus - 成熟的 Vue 3 组件库
- **样式方案**: SCSS - 提供变量、嵌套、混入等高级功能
- **类型系统**: TypeScript - 提供静态类型检查和更好的开发体验
- **AI 框架**: LangChain - 构建 LLM 应用的标准框架
- **本地模型**: Ollama - 本地部署的大语言模型服务
- **包管理器**: pnpm - 快速、节省磁盘空间的包管理器

### 项目结构

```
LangChainTS/
├── .trae/                    # Trae AI 配置
│   └── rules/
│       └── project_rules.md  # 项目规范文档
├── assets/                   # 静态资源
│   └── css/
│       └── style.css         # 全局样式
├── components/               # 可复用组件
├── config/                   # 配置文件
│   └── index.ts             # 应用配置
├── pages/                    # 页面组件
│   ├── hooks/               # 自定义 Hooks
│   │   └── useChat.ts       # 聊天功能 Hook
│   └── index.vue            # 主页面
├── public/                   # 公共静态文件
│   └── favicon.ico
├── server/                   # 服务端代码
│   ├── api/                 # API 路由
│   │   ├── chat.post.ts     # 聊天 API
│   │   └── user.ts          # 用户 API
│   ├── lib/                 # 服务端工具库
│   ├── plugins/             # Nitro 插件
│   │   └── app.ts
│   ├── routes/              # 服务端路由
│   │   └── getUser.ts
│   └── tsconfig.json        # 服务端 TS 配置
├── types/                    # TypeScript 类型定义
│   └── index.ts             # 全局类型
├── app.vue                   # 根组件
├── nuxt.config.ts           # Nuxt 配置
├── package.json             # 项目配置
├── tsconfig.json            # TypeScript 配置
└── README.md                # 项目说明
```

## 📝 编码规范

### TypeScript 规范

1. **严格模式**: 启用 TypeScript 严格模式
2. **类型定义**: 所有函数、变量、接口必须有明确的类型定义
3. **接口命名**: 使用 PascalCase，以 `I` 开头（可选）
4. **类型文件**: 统一放在 `types/` 目录下
5. **导入顺序**: 
   - 第三方库
   - 项目内部模块
   - 相对路径导入

### Vue 组件规范

1. **组件命名**: 使用 PascalCase
2. **文件命名**: 使用 kebab-case 或 PascalCase
3. **组件结构**: 
   ```vue
   <script lang="ts" setup>
   // 导入
   // 接口定义
   // 响应式数据
   // 计算属性
   // 方法
   // 生命周期
   </script>

   <template>
   <!-- 模板内容 -->
   </template>

   <style lang="scss" scoped>
   /* 样式 */
   </style>
   ```

4. **Props 定义**: 使用 TypeScript 接口定义
5. **事件命名**: 使用 kebab-case

### API 规范

1. **RESTful 设计**: 遵循 REST API 设计原则
2. **响应格式**: 统一的响应格式
   ```typescript
   interface ApiResponse<T = any> {
     code: number
     data: T
     message: string
   }
   ```
3. **错误处理**: 统一的错误处理机制
4. **状态码**: 使用标准 HTTP 状态码

### 样式规范

1. **CSS 方法论**: 使用 BEM 命名规范
2. **变量使用**: 使用 CSS 自定义属性和 SCSS 变量
3. **响应式设计**: 移动端优先的响应式设计
4. **组件样式**: 优先使用 scoped 样式

## 🔧 开发规范

### Git 规范

1. **分支命名**:
   - `feature/功能名称` - 新功能开发
   - `bugfix/问题描述` - 问题修复
   - `hotfix/紧急修复` - 紧急修复
   - `refactor/重构内容` - 代码重构

2. **提交信息**:
   ```
   type(scope): description

   [optional body]

   [optional footer]
   ```
   
   类型：
   - `feat`: 新功能
   - `fix`: 修复问题
   - `docs`: 文档更新
   - `style`: 代码格式调整
   - `refactor`: 代码重构
   - `test`: 测试相关
   - `chore`: 构建过程或辅助工具的变动

### 代码质量

1. **ESLint**: 使用 ESLint 进行代码检查
2. **Prettier**: 使用 Prettier 进行代码格式化
3. **TypeScript**: 启用严格的类型检查
4. **代码审查**: 所有代码必须经过 Code Review

### 测试规范

1. **单元测试**: 使用 Vitest 进行单元测试
2. **组件测试**: 使用 Vue Test Utils 进行组件测试
3. **E2E 测试**: 使用 Playwright 进行端到端测试
4. **测试覆盖率**: 保持 80% 以上的测试覆盖率

## 🚀 部署规范

### 环境配置

1. **开发环境**: 本地开发环境
2. **测试环境**: 用于功能测试
3. **预生产环境**: 生产环境的镜像
4. **生产环境**: 正式运行环境

### 环境变量

```bash
# Ollama 配置
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=qwen

# 应用配置
NODE_ENV=production
NUXT_PUBLIC_APP_NAME=LangChain Chat Assistant
```

### 构建优化

1. **代码分割**: 使用动态导入进行代码分割
2. **资源优化**: 压缩图片、CSS、JavaScript
3. **缓存策略**: 合理设置缓存策略
4. **CDN**: 使用 CDN 加速静态资源

## 📊 性能规范

### 前端性能

1. **首屏加载时间**: < 2 秒
2. **交互响应时间**: < 100ms
3. **Lighthouse 评分**: > 90 分
4. **包大小**: 主包 < 500KB

### 后端性能

1. **API 响应时间**: < 500ms
2. **并发处理**: 支持 100+ 并发请求
3. **内存使用**: < 512MB
4. **CPU 使用率**: < 70%

## 🔒 安全规范

### 数据安全

1. **输入验证**: 所有用户输入必须验证
2. **XSS 防护**: 防止跨站脚本攻击
3. **CSRF 防护**: 防止跨站请求伪造
4. **SQL 注入**: 使用参数化查询

### API 安全

1. **身份验证**: 实现用户身份验证
2. **权限控制**: 基于角色的访问控制
3. **速率限制**: 防止 API 滥用
4. **HTTPS**: 强制使用 HTTPS

## 📚 文档规范

### 代码文档

1. **函数注释**: 使用 JSDoc 格式
2. **类型注释**: TypeScript 类型即文档
3. **README**: 详细的项目说明
4. **API 文档**: 使用 OpenAPI 规范

### 项目文档

1. **架构文档**: 系统架构说明
2. **部署文档**: 部署流程和配置
3. **开发文档**: 开发环境搭建
4. **用户文档**: 用户使用指南

## 🔄 维护规范

### 依赖管理

1. **版本锁定**: 使用 lock 文件锁定版本
2. **安全更新**: 定期更新安全补丁
3. **依赖审计**: 定期审计依赖安全性
4. **版本升级**: 谨慎升级主要版本

### 监控告警

1. **错误监控**: 监控应用错误
2. **性能监控**: 监控应用性能
3. **日志管理**: 结构化日志记录
4. **告警机制**: 及时告警异常情况

## 🎯 最佳实践

### 开发实践

1. **小步提交**: 频繁提交小的更改
2. **功能分支**: 使用功能分支开发
3. **代码审查**: 所有代码必须审查
4. **自动化测试**: 编写自动化测试

### 性能优化

1. **懒加载**: 组件和路由懒加载
2. **缓存策略**: 合理使用缓存
3. **资源优化**: 压缩和优化资源
4. **监控分析**: 持续监控和分析

### 用户体验

1. **响应式设计**: 适配各种设备
2. **加载状态**: 提供加载反馈
3. **错误处理**: 友好的错误提示
4. **无障碍访问**: 支持无障碍访问

## 📋 检查清单

### 开发完成检查

- [ ] 代码符合规范
- [ ] 通过所有测试
- [ ] 文档已更新
- [ ] 性能符合要求
- [ ] 安全检查通过

### 发布前检查

- [ ] 功能测试通过
- [ ] 性能测试通过
- [ ] 安全测试通过
- [ ] 文档完整
- [ ] 部署脚本就绪

---

*本规范文档会根据项目发展持续更新和完善。*